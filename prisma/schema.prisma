generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  id        Int      @id @default(autoincrement())
  email     String   @unique
  name      String?
  password  String
  image     String?
  emailVerified DateTime?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  babies    Baby[]
}

model Baby {
  id        Int      @id @default(autoincrement())
  userId    Int
  name      String
  gender    String
  birthDate DateTime
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  // Relations
  data      BabyData[]

  @@index([userId])
}

model BabyData {
  id        Int      @id @default(autoincrement())
  babyId    Int
  monthAge  Int
  heightCm  Float
  weightKg  Float
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  baby      Baby     @relation(fields: [babyId], references: [id], onDelete: Cascade)

  @@index([babyId])
  @@unique([babyId, monthAge])
}

model WhoData {
  id             Int      @id @default(autoincrement())
  gender         String   // 'male' | 'female'
  monthAge       Int
  heightMedianCm Float
  weightMedianKg Float
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  @@unique([gender, monthAge])
}
